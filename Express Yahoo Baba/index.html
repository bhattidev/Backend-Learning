<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Student Records - CRUD</title>

    <!-- Bootstrap CSS CDN -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />
    <style>
      .student-img {
        width: 60px;
        height: 60px;
        object-fit: cover;
      }
      .action-buttons .btn {
        margin: 2px;
      }
      .table-container {
        background-color: white;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.1);
      }
      .page-title {
        color: #3b71ca;
        font-weight: 600;
        padding: 8px 0;
      }
      .search-container {
        position: relative;
      }
      .search-icon {
        position: absolute;
        left: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: #6c757d;
      }
      .search-input {
        padding-left: 35px;
      }
      .empty-state {
        text-align: center;
        padding: 3rem;
        color: #6c757d;
      }
      .toast-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 9999;
      }
      .gender-male {
        color: #0d6efd;
      }
      .gender-female {
        color: #d63384;
      }
      .gender-other {
        color: #6f42c1;
      }
    </style>
  </head>
  <body class="bg-light">
    <!-- Toast container for notifications -->
    <div aria-live="polite" aria-atomic="true" class="toast-container"></div>

    <div class="container py-4">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="page-title">
          <i class="bi bi-journal-bookmark-fill me-2"></i>Student Records
        </h2>
        <div>
          <button
            class="btn btn-success me-2"
            data-bs-toggle="modal"
            data-bs-target="#addStudentModal"
          >
            <i class="bi bi-person-plus-fill me-1"></i>Add Student
          </button>
          <button class="btn btn-primary" onclick="fetchStudents()">
            <i class="bi bi-arrow-clockwise me-1"></i>Refresh
          </button>
        </div>
      </div>

      <!-- Search + Buttons -->
      <div class="card mb-4">
        <div class="card-body py-3">
          <div class="row">
            <div class="col-md-6">
              <div class="search-container">
                <i class="bi bi-search search-icon"></i>
                <input
                  type="text"
                  id="searchInput"
                  class="form-control search-input"
                  placeholder="Search students by name, email, or phone..."
                />
              </div>
            </div>
            <div class="col-md-6 d-flex justify-content-end align-items-center">
              <div class="form-check form-switch">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="toggleGenderIcons"
                />
                <label class="form-check-label" for="toggleGenderIcons"
                  >Show Gender Icons</label
                >
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Students Table -->
      <div class="table-container">
        <div class="table-responsive">
          <table class="table table-hover mb-0 student-table">
            <thead class="table-dark">
              <tr>
                <th style="width: 80px">Profile</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th style="width: 100px">Gender</th>
                <th style="width: 220px" class="text-center">Actions</th>
              </tr>
            </thead>
            <tbody id="studentTableBody">
              <tr>
                <td colspan="7" class="text-center py-4">
                  <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                  </div>
                  <p class="mt-2 mb-0">Loading students...</p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Pagination -->
      <nav aria-label="Student pagination" class="mt-4">
        <ul class="pagination justify-content-center" id="paginationContainer">
          <li class="page-item disabled">
            <a class="page-link" href="#" tabindex="-1">Previous</a>
          </li>
          <li class="page-item active"><a class="page-link" href="#">1</a></li>
          <li class="page-item disabled">
            <a class="page-link" href="#">Next</a>
          </li>
        </ul>
      </nav>
    </div>

    <!-- ================= View Student Modal ================= -->
    <div
      class="modal fade"
      id="viewStudentModal"
      tabindex="-1"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header bg-info text-white">
            <h5 class="modal-title">
              <i class="bi bi-person-badge me-2"></i>Student Details
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <div class="text-center mb-4">
              <img
                src=""
                alt="Profile"
                id="viewProfilePic"
                class="rounded-circle border student-img"
                width="120"
                height="120"
              />
            </div>
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label fw-bold">First Name</label>
                <p id="viewFirstName" class="form-control-static"></p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label fw-bold">Last Name</label>
                <p id="viewLastName" class="form-control-static"></p>
              </div>
            </div>
            <div class="mb-3">
              <label class="form-label fw-bold">Email Address</label>
              <p id="viewEmail" class="form-control-static"></p>
            </div>
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label fw-bold">Phone Number</label>
                <p id="viewPhone" class="form-control-static"></p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label fw-bold">Gender</label>
                <p id="viewGender" class="form-control-static"></p>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ================= Add Student Modal ================= -->
    <div
      class="modal fade"
      id="addStudentModal"
      tabindex="-1"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header bg-success text-white">
            <h5 class="modal-title">
              <i class="bi bi-person-plus-fill me-2"></i>Add New Student
            </h5>
            <button
              type="button"
              class="btn-close btn-close-white"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <form id="addStudentForm" enctype="multipart/form-data" novalidate>
            <div class="modal-body">
              <div class="mb-3">
                <label for="profile_pic" class="form-label"
                  >Profile Picture</label
                >
                <input
                  type="file"
                  class="form-control"
                  id="profile_pic"
                  name="profile_pic"
                  accept="image/*"
                />
                <div class="form-text">
                  Optional. Accepted formats: JPG, PNG, GIF (Max 5MB)
                </div>
              </div>

              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="firstName" class="form-label"
                    >First Name <span class="text-danger">*</span></label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="firstName"
                    name="firstName"
                    placeholder="First Name"
                    required
                  />
                  <div class="invalid-feedback">
                    Please provide a first name
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="lastName" class="form-label"
                    >Last Name <span class="text-danger">*</span></label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="lastName"
                    name="lastName"
                    placeholder="Last Name"
                    required
                  />
                  <div class="invalid-feedback">Please provide a last name</div>
                </div>
              </div>

              <div class="mb-3">
                <label for="student_email" class="form-label"
                  >Email Address <span class="text-danger">*</span></label
                >
                <input
                  type="email"
                  class="form-control"
                  id="student_email"
                  name="email"
                  placeholder="Enter email"
                  required
                />
                <div class="invalid-feedback">
                  Please provide a valid email address
                </div>
              </div>

              <div class="mb-3">
                <label for="student_phone" class="form-label"
                  >Phone Number <span class="text-danger">*</span></label
                >
                <input
                  type="tel"
                  class="form-control"
                  id="student_phone"
                  name="phone"
                  placeholder="Enter phone number"
                  required
                />
                <div class="invalid-feedback">
                  Please provide a phone number
                </div>
              </div>

              <div class="mb-3">
                <label for="student_gender" class="form-label"
                  >Gender <span class="text-danger">*</span></label
                >
                <select
                  class="form-select"
                  id="student_gender"
                  name="gender"
                  required
                >
                  <option value="" disabled selected>Select gender</option>
                  <option value="Male">Male</option>
                  <option value="Female">Female</option>
                  <option value="Other">Other</option>
                </select>
                <div class="invalid-feedback">Please select a gender</div>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Cancel
              </button>
              <button type="submit" class="btn btn-primary">
                <i class="bi bi-plus-circle me-1"></i>Add Student
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- ================= Edit Student Modal ================= -->
    <div
      class="modal fade"
      id="editStudentModal"
      tabindex="-1"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header bg-warning">
            <h5 class="modal-title">
              <i class="bi bi-pencil-square me-2"></i>Edit Student
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <form id="editStudentForm" enctype="multipart/form-data" novalidate>
            <div class="modal-body">
              <input type="hidden" id="editStudentId" name="id" />

              <div class="text-center mb-3">
                <img
                  src=""
                  alt="Current Profile"
                  id="editCurrentProfilePic"
                  class="rounded-circle border student-img"
                  width="100"
                  height="100"
                />
                <div class="form-text mt-2">Current Profile Picture</div>
              </div>

              <div class="mb-3">
                <label for="editpic" class="form-label"
                  >Change Profile Picture</label
                >
                <input
                  type="file"
                  class="form-control"
                  id="editpic"
                  name="profile_pic"
                  accept="image/*"
                />
                <div class="form-text">Leave empty to keep current image</div>
              </div>

              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="editFirstName" class="form-label"
                    >First Name <span class="text-danger">*</span></label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="editFirstName"
                    name="firstName"
                    placeholder="First Name"
                    required
                  />
                  <div class="invalid-feedback">
                    Please provide a first name
                  </div>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="editLastName" class="form-label"
                    >Last Name <span class="text-danger">*</span></label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="editLastName"
                    name="lastName"
                    placeholder="Last Name"
                    required
                  />
                  <div class="invalid-feedback">Please provide a last name</div>
                </div>
              </div>

              <div class="mb-3">
                <label for="editemail" class="form-label"
                  >Email Address <span class="text-danger">*</span></label
                >
                <input
                  type="email"
                  class="form-control"
                  id="editemail"
                  name="email"
                  placeholder="Email"
                  required
                />
                <div class="invalid-feedback">
                  Please provide a valid email address
                </div>
              </div>

              <div class="mb-3">
                <label for="editphone" class="form-label"
                  >Phone Number <span class="text-danger">*</span></label
                >
                <input
                  type="text"
                  class="form-control"
                  id="editphone"
                  name="phone"
                  placeholder="Phone"
                  required
                />
                <div class="invalid-feedback">
                  Please provide a phone number
                </div>
              </div>

              <div class="mb-3">
                <label for="editgender" class="form-label"
                  >Gender <span class="text-danger">*</span></label
                >
                <select
                  class="form-select"
                  name="gender"
                  id="editgender"
                  required
                >
                  <option value="" disabled>Select Gender</option>
                  <option value="Male">Male</option>
                  <option value="Female">Female</option>
                  <option value="Other">Other</option>
                </select>
                <div class="invalid-feedback">Please select a gender</div>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Cancel
              </button>
              <button type="submit" class="btn btn-primary">
                <i class="bi bi-check-circle me-1"></i>Update Student
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      const apiUrl = "http://localhost:3000/api/students";
      let currentPage = 1;
      let totalPages = 1;
      let currentSearch = "";

      // Initialize the application
      document.addEventListener("DOMContentLoaded", function () {
        fetchStudents();
        setupEventListeners();
      });

      // ================= Setup Event Listeners =================
      function setupEventListeners() {
        // Search functionality with debounce
        let searchTimeout;
        document
          .querySelector("#searchInput")
          .addEventListener("input", (e) => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
              currentSearch = e.target.value;
              currentPage = 1;
              fetchStudents(currentSearch, currentPage);
            }, 500);
          });

        // Add student form validation
        document
          .getElementById("addStudentForm")
          .addEventListener("submit", handleAddStudent);

        // Edit student form validation
        document
          .getElementById("editStudentForm")
          .addEventListener("submit", handleEditStudent);

        // Toggle gender icons
        document
          .getElementById("toggleGenderIcons")
          .addEventListener("change", function () {
            fetchStudents(currentSearch, currentPage);
          });
      }

      // ================= Fetch All Students =================
      async function fetchStudents(search = "", page = 1) {
        try {
          showLoadingState();
          const res = await fetch(
            `${apiUrl}?search=${encodeURIComponent(search)}&page=${page}`
          );

          if (!res.ok) {
            throw new Error(`Server returned ${res.status}: ${res.statusText}`);
          }

          const data = await res.json();

          // Check if we have pagination info from the server
          if (data.pagination) {
            currentPage = data.pagination.currentPage;
            totalPages = data.pagination.totalPages;
            updatePagination();
          }

          renderStudents(data.students || data);
        } catch (error) {
          console.error("Error fetching students:", error);
          showError("Failed to load students. Please try again.");
        }
      }

      // ================= Render Students =================
      function renderStudents(students) {
        const tbody = document.querySelector("#studentTableBody");

        if (!students || students.length === 0) {
          tbody.innerHTML = `
            <tr>
              <td colspan="7">
                <div class="empty-state">
                  <i class="bi bi-people" style="font-size: 3rem;"></i>
                  <h5 class="mt-3">No students found</h5>
                  <p>Try adjusting your search or add a new student.</p>
                </div>
              </td>
            </tr>`;
          return;
        }

        const showGenderIcons =
          document.getElementById("toggleGenderIcons").checked;

        tbody.innerHTML = students
          .map((student) => {
            const profilePic = student.profile_pic
              ? `http://localhost:3000/uploads/${student.profile_pic}`
              : "https://placehold.co/70x70?text=No+Image";

            let genderIcon = "";
            if (showGenderIcons) {
              if (student.gender === "Male")
                genderIcon = '<i class="bi bi-gender-male text-primary"></i>';
              else if (student.gender === "Female")
                genderIcon = '<i class="bi bi-gender-female text-danger"></i>';
              else
                genderIcon =
                  '<i class="bi bi-gender-ambiguous text-success"></i>';
            }

            return `
            <tr>
              <td><img src="${profilePic}" class="rounded-circle student-img border"></td>
              <td>${student.firstName}</td>
              <td>${student.lastName}</td>
              <td>${student.email}</td>
              <td>${student.phone}</td>
              <td>${genderIcon} ${student.gender}</td>
              <td class="action-buttons">
                <button class="btn btn-info btn-sm" onclick="viewStudent('${student._id}')">
                  <i class="bi bi-eye me-1"></i>View
                </button>
                <button class="btn btn-warning btn-sm" onclick="editStudent('${student._id}')">
                  <i class="bi bi-pencil me-1"></i>Edit
                </button>
                <button class="btn btn-danger btn-sm" onclick="deleteStudent('${student._id}')">
                  <i class="bi bi-trash me-1"></i>Delete
                </button>
              </td>
            </tr>`;
          })
          .join("");
      }

      // ================= Show Loading State =================
      function showLoadingState() {
        const tbody = document.querySelector("#studentTableBody");
        tbody.innerHTML = `
          <tr>
            <td colspan="7" class="text-center py-4">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
              </div>
              <p class="mt-2 mb-0">Loading students...</p>
            </td>
          </tr>`;
      }

      // ================= Update Pagination =================
      function updatePagination() {
        const paginationContainer = document.getElementById(
          "paginationContainer"
        );
        if (totalPages <= 1) {
          paginationContainer.innerHTML = "";
          return;
        }

        let paginationHTML = `
          <li class="page-item ${currentPage === 1 ? "disabled" : ""}">
            <a class="page-link" href="#" onclick="changePage(${
              currentPage - 1
            })">Previous</a>
          </li>`;

        for (let i = 1; i <= totalPages; i++) {
          paginationHTML += `
            <li class="page-item ${i === currentPage ? "active" : ""}">
              <a class="page-link" href="#" onclick="changePage(${i})">${i}</a>
            </li>`;
        }

        paginationHTML += `
          <li class="page-item ${currentPage === totalPages ? "disabled" : ""}">
            <a class="page-link" href="#" onclick="changePage(${
              currentPage + 1
            })">Next</a>
          </li>`;

        paginationContainer.innerHTML = paginationHTML;
      }

      // ================= Change Page =================
      function changePage(page) {
        if (page < 1 || page > totalPages) return;
        currentPage = page;
        fetchStudents(currentSearch, currentPage);
      }

      // ================= View Student =================
      async function viewStudent(id) {
        try {
          const res = await fetch(`${apiUrl}/${id}`);
          if (!res.ok) {
            throw new Error(`Server returned ${res.status}: ${res.statusText}`);
          }

          const student = await res.json();

          document.querySelector("#viewProfilePic").src = student.profile_pic
            ? `http://localhost:3000/uploads/${student.profile_pic}`
            : "https://placehold.co/100x100?text=No+Image";

          document.querySelector("#viewFirstName").textContent =
            student.firstName;
          document.querySelector("#viewLastName").textContent =
            student.lastName;
          document.querySelector("#viewEmail").textContent = student.email;
          document.querySelector("#viewPhone").textContent = student.phone;
          document.querySelector("#viewGender").textContent = student.gender;

          new bootstrap.Modal(
            document.querySelector("#viewStudentModal")
          ).show();
        } catch (error) {
          console.error("Error fetching student:", error);
          showError("Failed to load student details. Please try again.");
        }
      }

      // ================= Add Student =================
      async function handleAddStudent(e) {
        e.preventDefault();

        const form = e.target;
        if (!form.checkValidity()) {
          e.stopPropagation();
          form.classList.add("was-validated");
          return;
        }

        try {
          const formData = new FormData(form);
          const submitBtn = form.querySelector('button[type="submit"]');
          const originalText = submitBtn.innerHTML;

          submitBtn.disabled = true;
          submitBtn.innerHTML =
            '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Adding...';

          const res = await fetch(apiUrl, {
            method: "POST",
            body: formData,
          });

          if (!res.ok) {
            const errorData = await res
              .json()
              .catch(() => ({ message: "Unknown error" }));
            throw new Error(
              errorData.message || `Server returned ${res.status}`
            );
          }

          showSuccess("Student added successfully!");
          form.reset();
          form.classList.remove("was-validated");

          bootstrap.Modal.getInstance(
            document.querySelector("#addStudentModal")
          ).hide();
          fetchStudents(currentSearch, currentPage);
        } catch (err) {
          console.error("Error adding student:", err);
          showError(`Failed to add student: ${err.message}`);
        } finally {
          const submitBtn = form.querySelector('button[type="submit"]');
          submitBtn.disabled = false;
          submitBtn.innerHTML = originalText;
        }
      }

      // ================= Edit Student =================
      async function editStudent(id) {
        try {
          const res = await fetch(`${apiUrl}/${id}`);
          if (!res.ok) {
            throw new Error(`Server returned ${res.status}: ${res.statusText}`);
          }

          const student = await res.json();

          // Fill form
          document.querySelector("#editStudentId").value = student._id;
          document.querySelector("#editFirstName").value = student.firstName;
          document.querySelector("#editLastName").value = student.lastName;
          document.querySelector("#editemail").value = student.email;
          document.querySelector("#editphone").value = student.phone;
          document.querySelector("#editgender").value = student.gender;

          // Set current profile picture
          const profilePic = student.profile_pic
            ? `http://localhost:3000/uploads/${student.profile_pic}`
            : "https://placehold.co/100x100?text=No+Image";
          document.querySelector("#editCurrentProfilePic").src = profilePic;

          // Reset validation
          document
            .getElementById("editStudentForm")
            .classList.remove("was-validated");

          new bootstrap.Modal(
            document.querySelector("#editStudentModal")
          ).show();
        } catch (error) {
          console.error("Error fetching student for edit:", error);
          showError(
            "Failed to load student data for editing. Please try again."
          );
        }
      }

      // ================= Update Student =================
      async function handleEditStudent(e) {
        e.preventDefault();

        const form = e.target;
        if (!form.checkValidity()) {
          e.stopPropagation();
          form.classList.add("was-validated");
          return;
        }

        try {
          const id = document.querySelector("#editStudentId").value;
          const formData = new FormData(form);
          const submitBtn = form.querySelector('button[type="submit"]');
          const originalText = submitBtn.innerHTML;

          submitBtn.disabled = true;
          submitBtn.innerHTML =
            '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Updating...';

          const res = await fetch(`${apiUrl}/${id}`, {
            method: "PUT",
            body: formData,
          });

          if (!res.ok) {
            const errorData = await res
              .json()
              .catch(() => ({ message: "Unknown error" }));
            throw new Error(
              errorData.message || `Server returned ${res.status}`
            );
          }

          showSuccess("Student updated successfully!");
          bootstrap.Modal.getInstance(
            document.querySelector("#editStudentModal")
          ).hide();
          fetchStudents(currentSearch, currentPage);
        } catch (err) {
          console.error("Error updating student:", err);
          showError(`Failed to update student: ${err.message}`);
        } finally {
          const submitBtn = form.querySelector('button[type="submit"]');
          submitBtn.disabled = false;
          submitBtn.innerHTML = originalText;
        }
      }

      // ================= Delete Student =================
      async function deleteStudent(id) {
        if (
          !confirm(
            "Are you sure you want to delete this student? This action cannot be undone."
          )
        ) {
          return;
        }

        try {
          const res = await fetch(`${apiUrl}/${id}`, { method: "DELETE" });

          if (!res.ok) {
            const errorData = await res
              .json()
              .catch(() => ({ message: "Unknown error" }));
            throw new Error(
              errorData.message || `Server returned ${res.status}`
            );
          }

          showSuccess("Student deleted successfully!");
          fetchStudents(currentSearch, currentPage);
        } catch (err) {
          console.error("Error deleting student:", err);
          showError(`Failed to delete student: ${err.message}`);
        }
      }

      // ================= Show Toast Notification =================
      function showToast(message, type = "info") {
        const toastContainer = document.querySelector(".toast-container");
        const toastId = "toast-" + Date.now();

        const toast = document.createElement("div");
        toast.className = `toast align-items-center text-white bg-${type} border-0`;
        toast.id = toastId;
        toast.setAttribute("role", "alert");
        toast.setAttribute("aria-live", "assertive");
        toast.setAttribute("aria-atomic", "true");

        toast.innerHTML = `
          <div class="d-flex">
            <div class="toast-body">
              ${message}
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
          </div>`;

        toastContainer.appendChild(toast);

        const bsToast = new bootstrap.Toast(toast, {
          autohide: true,
          delay: 5000,
        });

        bsToast.show();

        // Remove toast from DOM after it's hidden
        toast.addEventListener("hidden.bs.toast", () => {
          toast.remove();
        });
      }

      function showSuccess(message) {
        showToast(message, "success");
      }

      function showError(message) {
        showToast(message, "danger");
      }

      function showInfo(message) {
        showToast(message, "info");
      }
    </script>
  </body>
</html>
